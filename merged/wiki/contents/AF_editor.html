<html>
 <body>
  <p>
   This article describes the built-in articulated figure editor that comes with all
   <a href="Id_Tech_4" title="Id Tech 4">
    id Tech 4
   </a>
   games. Always check the editor specific page for the particular game you're editing in. The editor can be started by typing "
   <a href="EditAFs_%28console_command%29" title="EditAFs (console command)">
    editAFs
   </a>
   " in the
   <a href="Console" title="Console">
    console
   </a>
   or as a
   <a href="Startup_parameters" title="Startup parameters">
    startup parameter
   </a>
   .
  </p>
  <a name="Editor_Basics">
  </a>
  <h2>
   Editor Basics
  </h2>
  <div class="floatright">
   <span>
    <img alt="" height="689" src="/images/0/0b/Af_editor.gif" width="422"/>
   </span>
  </div>
  <p>
   When starting the editor you will be presented with two windows. The main game window and the articulated figure editor window.
  </p>
  <p>
   The editor window consists of a series of static controls and four tabs. The following sections will describe the purpose of these user interface elements, along with the purpose of any controls contained therein.
  </p>
  <a name="Static_Controls">
  </a>
  <h3>
   Static Controls
  </h3>
  <p>
   The following controls are always visible in the articulated figure editor window, irrespective of which tab is selected.
  </p>
  <ul>
   <li>
    Articulated Figure Selection - A drop down menu, in the upper left corner of the editor, that contains a list of all articulated figures. The articulated figure to edit is selected using this control. Almost all the Doom3 characters and monsters can be pulled into your test map this way.  When making a custom AF, it can be handy to occasionally pull up a Doom3 AF and see how your AF structure compares.
   </li>
   <li>
    New - A button, directly to the right of the articulated figure selection drop down, that clears out all properties allowing you to create a new articulated figure from scratch. If you have a custom skeleton and custom model, it's well advised to start from stratch, since the AF seems dependent on the bone names of the model skeleton.  If the bone names of your custom monster's skeleton don't exactly match the names of the ID AF you want to use, then the AF editor will crash.
   </li>
   <li>
    Delete - A button, directly to the right of the new button, that deletes the currently selected articulated figure. This button is only enabled when an articulated figure is selected. It is strongly urged that you NOT delete anything! Altering or editing the AF files of the Doom3 creatures/characters could ruin your game and you'd have to re-install it.
   </li>
   <li>
    Spawn - A button, in the bottom left corner of the editor, that spawns the selected articulated figure. If you selected char_hazmat in this drop down field, hitting the spawn button will make the hazmat suited guy appear in your game window, in his default pose, ready to be punched around.
   </li>
   <li>
    T-Pose - A button, directly to the right of the spawn button, that reverts the currently selected articulated figure to it's 'defualt' pose (usually called a T-pose because most character models are initally created in a standing position, with their arms spread out, so they look like a crude "T").  For example, if you spawned the char_hazmat guy and had punched or dragged him around so he was sprawling on the floor or draped over boxes, you could pop him back to his T-pose with this button.
   </li>
   <li>
    Kill - A button, directly to the right of the t-pose button, that removes any spawned entity from the game window completely, letting you pick another from the drop-down field, or re-spawn the same one.  For some reason, in editing AF files, the program becomes more stable when you first spawn the AF you want to edit, then kill it, then spawn it again.
   </li>
   <li>
    Save - A button, directly to the right of the kill button, that saves any changes you make to any spawned AF in the game window.  Again, it is strongly urged that you NOT make any changes to any Doom3 AF files and save them.  It could ruin your game and force you to re-install.  But any custom AF file you make shoud be saved early and saved OFTEN since the editor is very prone to crashes.  Make a habit of hitting SAVE for any change you make to any body or constraint.  THe save button will grey out once the AF file is saved, and you won't be able to save again unless you make some change to your file.
   </li>
   <li>
    Cancel - A button, directly to the right of the save button, that closes the AF editor, leaving the game window open.
   </li>
  </ul>
  <a name="View_Tab">
  </a>
  <h3>
   View Tab
  </h3>
  <p>
   The view tab in the AF editor has various controls to designate what and how things are displayed in the game window.  Most of the fields here, as stated on iddevnet.com, are "not saved when the AF is saved, they are simply to aid in development."
  </p>
  <p>
   The properties on this tab are categorized into four groups.
  </p>
  <a name="Articulated_Figure">
  </a>
  <h4>
   Articulated Figure
  </h4>
  <p>
   This group contains a series of check boxes you can toggle off or on with your mouse.
  </p>
  <ul>
   <li>
    Bodies - checking this will cause any BODY in your AF to be shown in the gaming map along with the mesh they control.  For example, the "char_hazmat" AF, if spawned with this box checked, will show the hazmat character model, and also show the 'bodies' which comprise his ragdoll - represented as hollow boxes, bones or other shapes.
   </li>
   <li>
    Body Names - checking this box will cause the NAMES for any created body to show in the game window.
   </li>
   <li>
    Body Mass - unsure
   </li>
   <li>
    Total Mass - unsure
   </li>
   <li>
    Inertia Tensor - unknown
   </li>
   <li>
    Velocity - unknown
   </li>
   <li>
    Constraints - checking this will display the CONSTRAINTS assigned to each body, represented by tiny XYZ axis markers.
   </li>
   <li>
    Constraint Names - checking this will display the names of any constraint in the AF in the gaming window.
   </li>
   <li>
    Primary Only - unknown
   </li>
   <li>
    Limits - Checking this box will display a cone so you can visually see the 'limits' of each body. This is very useful for setting the limit numbers, which otherwsie can be a real pain. IF you are using the display tab, you have to show constraints before you check the limts box.
   </li>
   <li>
    Constrained Bodies - unsure - presumably it will limit the display of BODIES in the game window to only show the ones that have CONSTRAINTS assigned to them.
   </li>
   <li>
    Trees - checking this box will cause the TREE structure of the AF to be displayed in the gaming window.  Properly formed, linked and working trees are usually represented by yellow lines, while broken or otherwise improperly formed trees are shown as blue lines.
   </li>
  </ul>
  <a name="MD5">
  </a>
  <h4>
   MD5
  </h4>
  <p>
   This group contains more display options relating to the display of the md5mesh that is linked to the AF in the game window.
  </p>
  <ul>
   <li>
    Skeleton - checking this box will cause the SKELETON for the mesh to be displayed in the game window.  For example, if the char_hazmat model is spawned and is showing in the game window, checking this box will display all the bones in the skeleton for this model, usually represented by thin, white lines.
   </li>
   <li>
    Skeleton Only - checking this box will remove the MESH from the gaming window and display only the skeleton that controls the animation for that mesh.  Again, if the char_hazmat were spawned in the gaming window, and if skeleton only was checked in the AF editor, you would not be able to see the mesh, but only the thin white lines which comprise it's animation skeleton.
   </li>
  </ul>
  <a name="Lines">
  </a>
  <h4>
   Lines
  </h4>
  <ul>
   <li>
    Depth Test
   </li>
   <li>
    Use Arrows
   </li>
  </ul>
  <a name="Physics">
  </a>
  <h4>
   Physics
  </h4>
  <p>
   This group contains various options to control how the AF can be interacted with in the game window, and options for how the AF will behave, above and beyond whatever limits you may set to the bodies.
  </p>
  <ul>
   <li>
    No Friction
   </li>
   <li>
    No Gravity - checking this box will 'turn off' the gravity in your test map in the game window, making 'floaty' corpses and so on as if there were no gravity.
   </li>
   <li>
    No Limits
   </li>
   <li>
    No Self Collision - unsure.  It may be this option turns off all collision detection within all the bodies in your AF, letting them swing around without bumping into each other.
   </li>
   <li>
    Drag entities - checking this box will let you 'drag' your AF around in the game window.  When your appear in a test map, you appear as if you were the Doom3 guy first popping up in a multiplayer map - with your fists, flashlight and pistol.  Checking drag entities will make your hands drop, leaving only the HUD crosshairs.  When you press your "Attack" button, instead of firing or punching, your character will 'grab' whatever the crosshairs are centered on.  If you 'grab' an AF body, you can then move around and the AF and it's linked mesh will be 'dragged' around with your crosshairs.  If your AF is properly made, you can then have fun throwing the ragdoll around and dragging it to see how it behaves.
   </li>
   <li>
    Show Drag Selection - unsure - presumably it highlights the particular 'body' of the AF that you have grabbed with drag entities on.
   </li>
   <li>
    Timings - unknown
   </li>
  </ul>
  <a name="Properties_Tab">
  </a>
  <h3>
   Properties Tab
  </h3>
  <a name="MD5_2">
  </a>
  <h4>
   MD5
  </h4>
  <ul>
   <li>
    Model:  Enter the NAME of the model you want to appear when you edit your AF.  When you click the SPAWN button in the VIEW tab, the model you have entered in this field will be the one that pops up.  If you had entered "char_hazmat" in this field, then the Doom3 Hazmat-suited guy would appear.  Doing this successfully depends on the model's actual name in the folder structure in Doom3 "models" folder.  If you are doing a custom character model, check your model folders.  If your directory structure is "C:/Doom3/base/models/md5/monsters/custom" for your custom model, type "custom" in the MD5/Model field of the PROPERTIES tab.
   </li>
  </ul>
  <ul>
   <li>
    Skin:  Unsure - presumably this will let you determine what texture map (.TGA) file you would like applied to the mesh.
   </li>
  </ul>
  <a name="Default_Collision_Detection">
  </a>
  <h4>
   Default Collision Detection
  </h4>
  <ul>
   <li>
    Self Collision
   </li>
   <li>
    Contents
   </li>
   <li>
    Clip Mask
   </li>
  </ul>
  <a name="Default_Friction">
  </a>
  <h4>
   Default Friction
  </h4>
  <ul>
   <li>
    Linear
   </li>
   <li>
    Angular
   </li>
   <li>
    Contact
   </li>
   <li>
    Constraint
   </li>
  </ul>
  <a name="Mass">
  </a>
  <h4>
   Mass
  </h4>
  <ul>
   <li>
    Total Mass:  Unsure.  Presumably this lets you set the overall MASS (weight) of your model as it will be interpreted by the Doom3 engine in game.  ID software does not recommend that you set your mass very high.  Numerous experiments with the settings in this field for various AF files has produced no significant change in AF behavior.  They don't seem to move much differently with a mass of "1" than if they have a mass of "500".  Request further edits/data if anyone has them.
   </li>
  </ul>
  <a name="Suspend_Speed">
  </a>
  <h4>
   Suspend Speed
  </h4>
  <ul>
   <li>
    Linear Velocity
   </li>
   <li>
    Angular Velocity
   </li>
   <li>
    Linear Acceleration
   </li>
   <li>
    Angular Acceleration
   </li>
  </ul>
  <a name="Suspend_Movement">
  </a>
  <h4>
   Suspend Movement
  </h4>
  <ul>
   <li>
    No Move Time
   </li>
   <li>
    Linear Tolerance
   </li>
   <li>
    Angular Tolerance
   </li>
   <li>
    Minimum Move Time
   </li>
   <li>
    Maximum Move Time
   </li>
  </ul>
  <a name="Bodies_Tab">
  </a>
  <h3>
   Bodies Tab
  </h3>
  <ul>
   <li>
    Body Selection - A drop down menu, in the upper left corner of the bodies tab, used to select the body to edit.
   </li>
   <li>
    New - A button, directly to the right of the body selection drop down, used to create a new body to edit.
   </li>
   <li>
    Rename - A button, directly to the right of the new button, used to rename the currently selected body.
   </li>
   <li>
    Delete -  A button, directy to the right of the rename button, used to delete the currently selected body.
   </li>
  </ul>
  <ul>
   <li>
    <b>
     IMPORTANT:
    </b>
    When you create a model in the 3D design suite of your choice,
    <b>
     be SURE to name your origin bone "origin" with NO capital letters
    </b>
    .  If your origin bone is not named "origin" precisely, the AF editor will NOT be able to 'find' your origin bone when you start to edit the BODIES of your model's AF.  The AF editor will CRASH because it will be looking for 'origin', and if it's named "Origin" or anything besides simply 'origin', the AF editor will freak out and the game will collapse.
   </li>
  </ul>
  <p>
   <i>
    The origin bone is the bone around which the AF editor 'spawns' every body for your AF - so this is extremely important to avoid crashing your AF editor.
   </i>
   It will close out every time you try to edit the default BODY created by the AF editor when you start building your AF file for a custom model.
  </p>
  <a name="Collision_model">
  </a>
  <h4>
   Collision model
  </h4>
  <ul>
   <li>
    Type
   </li>
   <li>
    Length
   </li>
   <li>
    Width
   </li>
   <li>
    Density
   </li>
   <li>
    Height
   </li>
   <li>
    Sides
   </li>
   <li>
    Inertia Scale
   </li>
  </ul>
  <p>
   <b>
    NOTE:
   </b>
   The collision model fields have the affected joints and controls on how they appear visually.  Most of these should be set to 'bone'.  Then in joint1, set the joint itself.  If you were working on the left upperleg, you would set joint1 to Lupleg.  Then have joint2 as the joint right BELOW it - in this case, Lloleg, the left lowerleg.  This will have the 'bone' span the area between the two joints and make it appear where it should be, with correct orientation.
As you get toward the end of the bone chains, say, the left lowerleg, this won't work since you want the chain to 'end' and not attach to another bone.  Set it to box, or cone depending on your taste, and pick it's position in the POSITION fields below.  Coordinates are more helpful since you can control exactly where you want it to go in the coordinates fields.  Bone center and "Joint" are useful only in certain situations, which I have not yet encountered.
  </p>
  <a name="Position">
  </a>
  <h4>
   Position
  </h4>
  <ul>
   <li>
    Coordinates
    <ul>
     <li>
      X
     </li>
     <li>
      Y
     </li>
     <li>
      Z
     </li>
    </ul>
   </li>
   <li>
    Bone Center
    <ul>
     <li>
      Bone Start Joint
     </li>
     <li>
      Bone End Joint
     </li>
    </ul>
   </li>
   <li>
    Joint
    <ul>
     <li>
      Joint Selection
     </li>
     <li>
      Pitch
     </li>
     <li>
      Yaw
     </li>
     <li>
      Roll
     </li>
    </ul>
   </li>
  </ul>
  <a name="Collision_Detection">
  </a>
  <h4>
   Collision Detection
  </h4>
  <ul>
   <li>
    Self Collision
   </li>
   <li>
    Contents
   </li>
   <li>
    Clip Mask
   </li>
  </ul>
  <a name="Friction">
  </a>
  <h4>
   Friction
  </h4>
  <ul>
   <li>
    Linear
   </li>
   <li>
    Angular
   </li>
   <li>
    Contact
   </li>
   <li>
    Friction Direction
   </li>
   <li>
    Motor Direction
   </li>
  </ul>
  <a name="Joints">
  </a>
  <h4>
   Joints
  </h4>
  <p>
   This field seems redundant since you cover all this in the collision model fields. Hopefully they'll come out with more documention on what these fields are for and what they control.
  </p>
  <ul>
   <li>
    Modified Joint - Set each BODY to be it's own modified joint.  If you are on the Lupleg body, set the modified joint to be "Lupleg".  If you're on the head, set it to the head or neck.
   </li>
   <li>
    Modify - what this is for I don't know.
   </li>
   <li>
    Contained Joints - The 'contained joints' field should have every body 'attached' to that particular body. Hence, the "Hips" or "Waist" body would have the origin bone, the body itself, and the two bodies 'below' it - the right upper leg and left upper leg.
   </li>
  </ul>
  <p>
   The 'chest' body of the hazmat guy would have the waist (below) and the Right upperarm and leftupperarm, along with the body above it, the neck and/or head.
The left upperarm would have contained joints of the joint itself, leftupperarm, and the attached body of left lowerarm.
Toward the end of the bone/body 'chain', it should contain only it's own joints.  Hence, the "Lloleg" joint/body would contain only Lloleg, Lloarm contains only Lloarm, and so on.
  </p>
  <p>
   You use a star (*) to indicate that all bones including and after the starred one is to be included in the selection.
You use a hyphen and star (-*) to indicate that all bones including and after that will be excluded.
You use a hyphen (-) to indicte that the specific bone only will be included.
  </p>
  <p>
   So if your skeleton's arm bone hierarchy was made like this: upperarm - upperarmroll - forearm - forearmroll - hand,
for the uparm collision body you would set it to Code: *upperarm  -*forearm
  </p>
  <p>
   That's telling it to include upperarm and upperarmroll, but to exclude the forearm and all bones after it in the chain.
  </p>
  <p>
   Then for the lowerarm collision body you use Code: *forearm
  </p>
  <p>
   That is telling it to include forearm and all the bones that come after it.
  </p>
  <p>
   IF you had put Code: *upperarm
for the uparm body, and Code: *forearm for the lowarm body, you would get an error in the console saying that the forearm bones are included in two bodies, becasue they are included in both the uparm and lowerarm bodies.
You cannot have a bone present in more that one collision body.
  </p>
  <a name="Constraints_Tab">
  </a>
  <h3>
   Constraints Tab
  </h3>
  <ul>
   <li>
    Constraint Selection - A drop down menu, in the upper left corner of the constraints tab, used to select the constraint to edit.
   </li>
   <li>
    New - A button, directly to the right of the constraint selection drop down, used to create a new constraint to edit.
   </li>
   <li>
    Rename - A button, directly to the right of the new button, used to rename the currently selected constraint.
   </li>
   <li>
    Delete -  A button, directy to the right of the rename button, used to delete the currently selected constraint.
   </li>
  </ul>
  <p>
   <b>
    NOTE:
   </b>
   Each BODY must have it's own CONSTRAINT set by hitting the "NEW" button on the constriants tab, and then SAVED.
  </p>
  <a name="General">
  </a>
  <h4>
   General
  </h4>
  <ul>
   <li>
    Type
   </li>
   <li>
    Friction
   </li>
   <li>
    Body1
   </li>
   <li>
    Body2
   </li>
  </ul>
  <p>
   <b>
    NOTE:
   </b>
   When setting BODY1 and BODY2 in the GENERAL section of the CONTSTRAINTS tab, BODY1 is always the actual BODY itself - BODY2 should be the body that BODY1 connects to.  Hence, for the HEAD, Body1 would be HEAD and body2 would be the neck or chest.  If you were setting constraints for the right upper leg, BODY1 would be "Rupleg" and BODY2 would be "Hips" (or whichever body you have named/listed as the PELVIS)
  </p>
  <p>
   <b>
    The TREE structures for a model's AF are dependent on these Body1/Body2 settings.
   </b>
   In order for your AF's tree structure to turn yellow (showing that all your AF's 'limbs' are properly connected), you have to have each CONSTRAINT properly linked.  The model's TREE structure can be shown by checking the "show trees" box in the VIEW tab.
   <b>
    Not having your AF tree structure showing as all yellow lines means that links are not properly formed and limbs will not move/behave properly.
   </b>
  </p>
  <p>
   Think of it in terms of a chain. If there were three links in the chain, named 'upperlink' 'midlink' and 'lowlink', and if you had set a constraint for each one and were now entering their settings in the constraints/general tab, the settings for proper TREE Structure would be thus:
  </p>
  <p>
   Constraint body settings for upperlink:
body1:Â ? body2: upperlink
  </p>
  <p>
   Constraint body settings for midlink:
body1: midlink body2: upperlink
  </p>
  <p>
   Settings for lowlink:
body1: lowlink body2: midlink
  </p>
  <p>
   The 'central' link in an AF set does NOT appear in your selection of choices for body1 - presumably because there is nothing 'above' it to link to - all the OTHER chains connect to THAT body.  (More info/edits requested)
  </p>
  <a name="Anchor">
  </a>
  <h4>
   Anchor
  </h4>
  <ul>
   <li>
    Joint
    <ul>
     <li>
      Anchor Joint Selection
     </li>
    </ul>
   </li>
   <li>
    Coordinates
    <ul>
     <li>
      X
     </li>
     <li>
      Y
     </li>
     <li>
      Z
     </li>
    </ul>
   </li>
  </ul>
  <p>
   <b>
    NOTE:
   </b>
   The JOINT part under the anchor section should be set to the actual body.  Hence, if you are setting an anchor for the HEAD body, you would select the HEAD joint, etc.
  </p>
  <a name="Shaft_1">
  </a>
  <h4>
   Shaft 1
  </h4>
  <ul>
   <li>
    Bone
    <ul>
     <li>
      Bone Start Joint
     </li>
     <li>
      Bone End Joint
     </li>
    </ul>
   </li>
   <li>
    Angles
    <ul>
     <li>
      Pitch Angle
     </li>
     <li>
      Yaw Angle
     </li>
    </ul>
   </li>
  </ul>
  <a name="Shaft_2">
  </a>
  <h4>
   Shaft 2
  </h4>
  <ul>
   <li>
    Bone
    <ul>
     <li>
      Bone Start Joint
     </li>
     <li>
      Bone End Joint
     </li>
    </ul>
   </li>
   <li>
    Angles
    <ul>
     <li>
      Pitch Angle
     </li>
     <li>
      Yaw Angle
     </li>
    </ul>
   </li>
  </ul>
  <a name="Limit_Type">
  </a>
  <h4>
   Limit Type
  </h4>
  <ul>
   <li>
    None
   </li>
   <li>
    Cone
    <ul>
     <li>
      Cone Angle
     </li>
    </ul>
   </li>
   <li>
    Pyramid
    <ul>
     <li>
      Pitch
     </li>
     <li>
      Yaw
     </li>
     <li>
      Roll
     </li>
    </ul>
   </li>
  </ul>
  <a name="Limit_Orientation">
  </a>
  <h4>
   Limit Orientation
  </h4>
  <ul>
   <li>
    Bone
    <ul>
     <li>
      Bone Start Joint
     </li>
     <li>
      Bone End Joint
     </li>
    </ul>
   </li>
   <li>
    Angles
    <ul>
     <li>
      Pitch Angle
     </li>
     <li>
      Yaw Angle
     </li>
    </ul>
   </li>
  </ul>
  <a name="Tips">
  </a>
  <h2>
   Tips
  </h2>
  <p>
   SAVE often - make it a habit to SAVE your AF file on every edit if you can.  The editor is very finicky and prone to crashing.
  </p>
  <p>
   The AF editor seems to work best (and crash least) when working out the the regular BASE doom3 directory, as opposed to files kept in a seperate folder.  The reasons for this are still unknown.
  </p>
  <p>
   Hit kill in AF editor after spawning your entity for the first time - then spawn it again before editing any body/constraint properties.  For some reason, this seems to make the AF editor more stable and less prone to crashing.
  </p>
  <!-- Saved in parser cache with key modwiki:pcache:idhash:1681-0!1!0!0!!en!2 and timestamp 20080705224814 -->
 </body>
</html>
