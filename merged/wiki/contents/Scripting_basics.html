<html>
 <body>
  <div class="boilerplate metadata" id="attention" style="background-color: #fee; margin: 0 1em; padding: 0 10px; border: 1px solid #aaa;">
   <p>
    <b>
     This page is in urgent need of attention because:
     <i>
      Unfinished sections
     </i>
    </b>
   </p>
   <p>
    If you disagree with this, please explain why on
    <a href="Talk:Scripting_basics" title="Talk:Scripting basics">
     its talk page
    </a>
    .
   </p>
  </div>
  <p>
   <a href="SCRIPT_%28file_format%29" title="SCRIPT (file format)">
    SCRIPT
   </a>
   files define a scripted sequence of events, the behavior of weapons, or the AI of actors. The files themselves are ascii (plain text) and can be edited/created in a text editor like notepad.
  </p>
  <p>
   Scripts use a proprietary language similar to C++, Java, and other languages but it's very rudimentary and nowhere near as complex.
  </p>
  <a name="Basics_of_Programming">
  </a>
  <h2>
   Basics of Programming
  </h2>
  <p>
   Programming and scripting are essentially the same task. The only distinguishable difference between the two is scripting is instructing a specific program to perform a task where as programming involves writing a program itself.
  </p>
  <p>
   The general concept behind scripting is the same and so, in order to script you need to learn to program. But, it's not nearly as scary as it sounds.
  </p>
  <p>
   When you are scripting you are telling objects to perform certain tasks. But these objects don’t understand English. You need to talk to them in a manner that they can understand.
  </p>
  <p>
   For the time being we will relate to the way people perform tasks. Let’s say you want to open a door. We all know how to do so but this simple task can be broken down into a series of basic steps.
  </p>
  <p>
   <br/>
   <b>
    Opening a Door
   </b>
  </p>
  <ol>
   <li>
    Extend your hand to reach the door.
   </li>
   <li>
    Grasp the knob.
   </li>
   <li>
    Turn the knob.
   </li>
   <li>
    Pull the knob.
   </li>
  </ol>
  <p>
   <br/>
   To even make things worse those basic steps can be broken down even further.
  </p>
  <p>
   <br/>
   <b>
    Extend your hand to reach the door.
   </b>
  </p>
  <ol>
   <li>
    Raise your arm.
   </li>
   <li>
    Rotate your forearm.
   </li>
   <li>
    Open your hand.
   </li>
  </ol>
  <p>
   <br/>
   You can see how even a simple task like opening a door is actually comprised of a lengthy list of basic actions. This is the basis of scripting in Doom 3 and programming in general. You cannot just tell a machine to run. You have to tell all its moving parts to perform basic actions.
  </p>
  <a name="General_Syntax">
  </a>
  <h2>
   General Syntax
  </h2>
  <p>
   The following is a list of special characters with a special meaning; they need to be remembered.
  </p>
  <dl>
   <dt>
    ;
   </dt>
   <dd>
    Follows all commands. More than one command may exist on a single line. Informs the engine that the following is the end of a command.
   </dd>
  </dl>
  <pre><span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">print</span>;</pre>
  <dl>
   <dt>
    //
   </dt>
   <dd>
    Comment. Declares the text from this point to the end of the line a comment and is not executed. Can also be used to null out a line of code for debugging.
   </dd>
  </dl>
  <pre><span style="color: #339900;">// This text will not be executed. </span>
 </pre>
  <dl>
   <dt>
    /* and */
   </dt>
   <dd>
    Comment. Declares the text from /* to */ a comment and the text contained therein is not executed. Can also be used to null out a portion of code for debugging.
   </dd>
  </dl>
  <pre><span style="color: #339900; font-style: italic;">/* This text will not be executed. */</span></pre>
  <a name="Getting_started">
  </a>
  <h2>
   Getting started
  </h2>
  <p>
   First of all, it is recommended to use a good editor with syntax highlighting. This allows you to see typing errors because the highlighted color changes if the editor doesn't know your input. To find a suitable text editor, see
   <a href="SCRIPT_%28file_format%29#Editing_tools" title="SCRIPT (file format)">
    tools for editing script files
   </a>
   .
  </p>
  <p>
   Now to start with something, we will make a small and easy level script. These are the easiest to start with and make a nice introduction to scripting. What do we need?
  </p>
  <ul>
   <li>
    A map with a player spawn point in it. (Use anything you have, be it a simple box with a light in it.)
   </li>
   <li>
    A script file with the same name as the map, placed in the maps folder.
   </li>
  </ul>
  <p>
   Open the map and create a new brush. Select it, then open the "Entities" inspector/window. Now add a key "call" with the value "main". What this means for this example is that a function named "main" will be called when the map loads.
  </p>
  <p>
   Now open the script file and paste this code fragment in it.
  </p>
  <pre><span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">print</span><span style="color: #000000;">(</span><span style="color: #666666;">"^1Hello "</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"^3World!"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   If you now run the map, open your console by pressing Ctrl + Alt + ~. If all went well, there should be a line with the text "Hello World!" in two different colors. This example might be far from impressive, but it should be enough to let you experiment once you have read more about scripting.
  </p>
  <p>
   With that out of the way, let's look at some theory first. If you already know C or some other procedure-based language, feel free to quickly read the following 2 parts. If you are completely new to it, these sections should teach you the basics.
  </p>
  <a name="Variables">
  </a>
  <h2>
   Variables
  </h2>
  <p>
   A variable is a container used to store a value. Think of it as an alias used to refer to a value without referencing the value directly.
  </p>
  <a name="Declaration">
  </a>
  <h3>
   Declaration
  </h3>
  <p>
   Before a variable can be used it must be declared for a specific
   <a href="Data_types" title="Data types">
    data type
   </a>
   . By assigning a data type you are defining what kind of values can be stored in a specific variable.
  </p>
  <p>
   Say we want to create a variable called "foo" and store a number in it. The variable declaration would look like this:
  </p>
  <pre><span style="color: #0000ff;">float</span> foo;</pre>
  <p>
   If you would need more then one variable of the same type, you could write
  </p>
  <pre><span style="color: #0000ff;">float</span> foo1;
<span style="color: #0000ff;">float</span> foo2;</pre>
  <p>
   like this:
  </p>
  <pre><span style="color: #0000ff;">float</span> foo1, foo2;</pre>
  <p>
   To actually put a number in it, you would do this:
  </p>
  <pre>foo = <span style="color: #0000dd;">2</span>;</pre>
  <p>
   More examples of can be found on the
   <a href="Data_types" title="Data types">
    Data types
   </a>
   page, see the common types.
  </p>
  <p>
   Now, how to put variables to use? 
The nice thing is that you can write the variable's name where you would normally put a value of that type. This way, you can use the same code over and over without changing that line of code. You just assign a new value to the variable instead of copying your code and changing the value there.
  </p>
  <a name="Operations">
  </a>
  <h3>
   Operations
  </h3>
  <p>
   Now you basically know what a variable does. However, the assignment operation is just one of many.
  </p>
  <p>
   Imagine that you want to make a counter. You would first need to check the old value and then assign the new one to it. Of course, this would take a lot of work.
  </p>
  <p>
   Luckily, we can do basic operations with values. They can be as easy as this:
  </p>
  <pre><span style="color: #0000dd;">1</span> + <span style="color: #0000dd;">1</span></pre>
  <p>
   A few of the supported operations are:
  </p>
  <ul>
   <li>
    <dl>
     <dt>
      +
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Addition
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      -
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Subtraction
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      *
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Multiplication
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      /
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Division
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      %
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Modulo (Results in the remainder of a division)
   </dd>
  </dl>
  <p>
   Since an operation results in a value of the same type, you can store the results of an operation in a variable:
  </p>
  <pre>foo = <span style="color: #0000dd;">1</span> + <span style="color: #0000dd;">1</span>;</pre>
  <p>
   Now back to the counter example:
  </p>
  <p>
   Remember that a variable is an alias to a value? That way, we can use a variable with an operation:
  </p>
  <pre>foo = foo + <span style="color: #0000dd;">1</span>;</pre>
  <p>
   Variables are especially useful in functions, so make sure you understand this part before going to that section.
  </p>
  <a name="Logical_structures">
  </a>
  <h2>
   Logical structures
  </h2>
  <p>
   So far we explained how to define variables and do a little arithmetic with them. While this is certainly useful for making counters, those counters can never be put to use if you couldn't compare their value against another to do something. This is where logical structures come in. They allow you to exclude or repeat certain instructions based on a logical condition.
  </p>
  <p>
   We'll start with a basic one, the
   <b>
    if
   </b>
   structure.
  </p>
  <a name="If_structure">
  </a>
  <h3>
   If structure
  </h3>
  <p>
   The name says all: "
   <b>
    if
   </b>
   the condition is true,
   <b>
    do
   </b>
   ...". Take the following code for example:
  </p>
  <pre><span style="color: #0000ff;">boolean</span> condition1 = true;
<span style="color: #0000ff;">boolean</span> condition2 = false;
<span style="color: #0000ff;">float</span> var1 = <span style="color: #0000dd;">0</span>;
 
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> condition1 <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    var1 = var1 + <span style="color: #0000dd;">2</span>;
<span style="color: #000000;">}</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> condition2 <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    var1 = var1 - <span style="color: #0000dd;">2</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   Seeing how only
   <i>
    condition1
   </i>
   is set to true, only the statements inside the first
   <b>
    if
   </b>
   structure will be executed. In this case,
   <i>
    var1
   </i>
   will be set to '2'. Of course, using static variables as conditions is not of great use because we could as well comment out all statements for which the condition was false. To really harness the power of logical structures we need logical operations, which we'll discuss next.
  </p>
  <a name="Logical_Operations">
  </a>
  <h3>
   Logical Operations
  </h3>
  <p>
   Logical operators are symbols which return a boolean value, just like the arithmetic operators return a number. However, these operators work on more than just
   <b>
    float
   </b>
   -type variables. See the list below for details, the data types the operators work on are between parentheses.
  </p>
  <ul>
   <li>
    <dl>
     <dt>
      ==
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Equals (float, boolean, string?, entity?)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      &lt;
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Less than (float)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      &lt;=
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Lesser or equals (float)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      &gt;
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Greater than (float)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      &gt;=
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Greater or equals (float)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      !
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Negation (boolean)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      &amp;&amp;
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Logical And (boolean)
   </dd>
  </dl>
  <ul>
   <li>
    <dl>
     <dt>
      ||
     </dt>
    </dl>
   </li>
  </ul>
  <dl>
   <dd>
    Logical Or (boolean)
   </dd>
  </dl>
  <p>
   Here are some examples:
  </p>
  <pre><span style="color: #0000ff;">float</span> var1 = <span style="color: #0000dd;">5</span>;
<span style="color: #0000ff;">float</span> var2 = <span style="color: #0000dd;">10</span>;
<span style="color: #0000ff;">float</span> var3 = <span style="color: #0000dd;">5</span>;
 
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> var1 == var3 <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #339900;">// Execute statements</span>
<span style="color: #000000;">}</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> var1 &gt;= var2 <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #339900;">// Will never get executed</span>
<span style="color: #000000;">}</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> var1 &lt;= var2 &amp;&amp; var3 &lt;= var2 <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #339900;">// Execute this one as well</span>
<span style="color: #000000;">}</span>
 
<span style="color: #339900;">// etc. </span>
 </pre>
  <p>
   Also note that you can mix arithmetic and boolean operators, for example:
  </p>
  <pre> var1 + 5 == var2
</pre>
  <p>
   The script compiler will process
   <i>
    var1
   </i>
   + 5 first and the compare the float values. Because they're both 10, the resulting value will be
   <b>
    true
   </b>
   .
  </p>
  <a name="While_structure">
  </a>
  <h3>
   While structure
  </h3>
  <p>
   A
   <i>
    while
   </i>
   structure executes a set of instructions as long as a given statement is true. It analyses conditions the same way
   <i>
    if
   </i>
   structures do. For example:
  </p>
  <pre> 
<span style="color: #0000ff;">float</span> myVar = <span style="color: #0000dd;">0</span>;
 
<span style="color: #0000ff;">while</span> <span style="color: #000000;">(</span>myVar &lt; <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">print</span><span style="color: #000000;">(</span><span style="color: #666666;">"myVar: "</span> + myVar + <span style="color: #666666;">"<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
	myVar++;
<span style="color: #000000;">}</span></pre>
  <p>
   myVar starts out with a value of 0. As long as its value is smaller than 10, it will be displayed in the console, then incremented by 1.
  </p>
  <p>
   <br/>
   The
   <i>
    while
   </i>
   loop will do two things:
  </p>
  <ul>
   <li>
    First, it will print the text "myVar:" followed by myVar's value, then start a new line.
   </li>
   <li>
    Then, it will add 1 to myVar's value. The "++" after the variable name means the variable will be incremented by 1. (This is like typing
    <i>
     myVar = myVar + 1
    </i>
    .)
   </li>
  </ul>
  <a name="For_structure">
  </a>
  <h3>
   For structure
  </h3>
  <p>
   This structure is the odd one because it combines the repeat condition of the
   <b>
    while
   </b>
   structure with the initializer statements, the condition and the increment combined.
  </p>
  <p>
   TODO: elaborate use and examples
  </p>
  <a name="Functions_or_Methods">
  </a>
  <h2>
   Functions or Methods
  </h2>
  <p>
   Functions are used to group certain statements and let you reuse them in other parts of the code.
  </p>
  <p>
   You will use them for one of the following reasons:
  </p>
  <ul>
   <li>
    They can just group  some statements so that you don't need to copy/paste them over again.
   </li>
   <li>
    They group statements which will need to be called by a map entity.
   </li>
   <li>
    They can execute some statements which needs different input values from time to time. (The input values will be called
    <i>
     parameters
    </i>
    , read on for more.)
   </li>
   <li>
    They can execute a few statements to calculate or generate one value.
   </li>
  </ul>
  <a name="Declaration_2">
  </a>
  <h3>
   Declaration
  </h3>
  <a name="Simple">
  </a>
  <h4>
   Simple
  </h4>
  <p>
   Just like a variable needs a declaration, a function needs to be declared to be used by the script parser.
We will start with the first use, grouping statements. (Which is the easiest)
You should be able to figure out what the folowing function does as a whole.
  </p>
  <pre><span style="color: #0000ff;">void</span> printHello<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">print</span><span style="color: #000000;">(</span><span style="color: #666666;">"Hello "</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"World"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   Let's take a look at it in detail:
  </p>
  <ul>
   <li>
    The first line defines the return type, function's name and parameters. (More on those later on.)
   </li>
   <li>
    The function consists of everything enclosed in the first set of curly brackets ('{' and '}') after the function's definition.
   </li>
  </ul>
  <p>
   These functions can also be called by map entitities. Just give them a key "call" with your function's name as a value.
  </p>
  <a name="Using_parameters">
  </a>
  <h4>
   Using parameters
  </h4>
  <p>
   Another reason to use funtions is reusability. What this means is that you can reuse parts of your script instead of writing it again. Reusing code helps in reducing mistakes since you only have to fix a mistake once. If you would have copied and pasted the code, you might need to fix it multiple times.
  </p>
  <p>
   To make a function be reusable, it will need to operate on different things. So, we'll simply put those in variables and feed those to the function. You could define all variables globally, but functions have a nicer way of doing things using
   <i>
    parameters
   </i>
   . Example:
  </p>
  <pre> 
<span style="color: #339900;">// This function makes an entity rotate around the Z axis, it takes spinTime seconds to complete one turn</span>
<span style="color: #0000ff;">void</span> spinZ<span style="color: #000000;">(</span><span style="color: #0000ff;">float</span> spinTime, <span style="color: #0000ff;">entity</span> target<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    target.<span style="color: #ff0000;">time</span><span style="color: #000000;">(</span>spinTime<span style="color: #000000;">)</span>;   <span style="color: #339900;">// Set the time each spin takes in this example</span>
    target.<span style="color: #ff0000;">rotate</span><span style="color: #000000;">(</span>'<span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">90</span>'<span style="color: #000000;">)</span>; <span style="color: #339900;">// Rotate around the Z axis.</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    spinZ<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span>,  <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span><span style="color: #666666;">"func_mover_1"</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    spinZ<span style="color: #000000;">(</span><span style="color: #0000dd;">10</span>, <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span><span style="color: #666666;">"func_mover_2"</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   As you can see, the first line now can have one or more
   <i>
    variable
   </i>
   definitions between the round brackets. The calling statements set the values accordingly.
  </p>
  <a name="Return_values">
  </a>
  <h4>
   Return values
  </h4>
  <p>
   Finally the last reason: calculating or choosing values. Sometimes you will need to do some math in several places, or check a few conditions. Wouldn't it be handy to place them in a function and get one nice value instead of duplicating the code everywhere?
  </p>
  <p>
   Return values let you do that -- the function does its magic and returns one single value. Here is an example:
  </p>
  <pre> 
<span style="color: #339900;">// Returns true when entities are near each other</span>
<span style="color: #0000ff;">boolean</span> isNear<span style="color: #000000;">(</span><span style="color: #0000ff;">entity</span> first, <span style="color: #0000ff;">entity</span> second<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">float</span> dist = first.<span style="color: #ff0000;">distanceTo</span><span style="color: #000000;">(</span> second <span style="color: #000000;">)</span>; <span style="color: #339900;">// Returns their distance in units</span>
    <span style="color: #0000ff;">boolean</span> near = <span style="color: #000000;">(</span>dist &lt; <span style="color: #0000dd;">20</span><span style="color: #000000;">)</span>;
    return near;
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">entity</span> ent1 = <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span><span style="color: #666666;">"func_mover_1"</span><span style="color: #000000;">)</span>;
    <span style="color: #339900;">// Does the same as the statement above, but for "func_mover_2"</span>
    <span style="color: #0000ff;">entity</span> ent2 = <span style="color: #000055;">$func_mover_<span style="color: #0000dd;">2</span></span>;
 
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> isNear<span style="color: #000000;">(</span> ent1, ent2<span style="color: #000000;">)</span> <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"They are near each other"</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #000000;">{</span>
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"They are away from each other"</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>
  <p>
   Note that this is just an example: it is only written to show how return values work. Also take a look at the entites: this example shows the use of
   <b>
    $entityname
   </b>
   and the
   <b>
    if
   </b>
   /
   <b>
    else
   </b>
   structure.
  </p>
  <a name="More_examples">
  </a>
  <h3>
   More examples
  </h3>
  <p>
   Here is a somewhat longer example, combining a few of the discussed things.
  </p>
  <div class="boilerplate metadata" id="stub">
   <i>
    This article is a
    <a class="external text" href="http://en.wikipedia.org/wiki/Perfect_stub_article" title="http://en.wikipedia.org/wiki/Perfect_stub_article">
     stub
    </a>
    . You can help us by
    <span class="plainlinks">
     <a class="external text" href="Scripting_basics" title="http://www.modwiki.net/w/index.php?title=Scripting_basics&amp;action=edit">
      expanding it
     </a>
    </span>
    .
   </i>
  </div>
  <pre><span style="color: #0000ff;">boolean</span> doorisunlocked;
 
<span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 doorisunlocked = <span style="color: #0000dd;">0</span>; <span style="color: #339900;">//initialize to 0=false...not really necessary</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> func_door_<span style="color: #0000dd;">001</span>_unlock<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 doorisunlocked = <span style="color: #0000dd;">1</span>; <span style="color: #339900;">//set to 1=true</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">boolean</span> doorcheck<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>doorisunlocked<span style="color: #000000;">)</span>
 <span style="color: #000000;">{</span>
  return <span style="color: #0000dd;">1</span>;
 <span style="color: #000000;">}</span>
 <span style="color: #0000ff;">else</span>
 <span style="color: #000000;">{</span>
  return <span style="color: #0000dd;">0</span>;
 <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> checkdoor<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>doorcheck<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
 <span style="color: #000000;">{</span>
  <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"door is unlocked"</span><span style="color: #000000;">)</span>;
 <span style="color: #000000;">}</span>
 <span style="color: #0000ff;">else</span>
 <span style="color: #000000;">{</span>
  <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"door is still locked"</span><span style="color: #000000;">)</span>;
 <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>
  <a name="Entities">
  </a>
  <h2>
   Entities
  </h2>
  <p>
   If you play a map, nearly everything you see is actually an entity. They form movable furniture, working machines, weapon, monsters and even the player itself. If they are used in so many places, wouldn't it be logical to have control over them through scripting? The answer is 'yes', of course. You can control entities through scripts, as long as you know their name.
  </p>
  <p>
   Now all we need is an exact way to "talk" to those entities. That is what
   <b>
    script events
   </b>
   do: send a certain message to an entity, and the entity can do something with it. If you look at them in the script, they look a lot like functions. The only difference is that you always need to specify which entity you are sending 'the message' to. Now let's look at an example, shall we:
  </p>
  <pre><span style="color: #000055;">$my_entity</span>.<span style="color: #ff0000;">setWorldOrigin</span><span style="color: #000000;">(</span>'<span style="color: #0000dd;">57</span> <span style="color: #0000dd;">68</span> <span style="color: #0000dd;">19</span>'<span style="color: #000000;">)</span>;</pre>
  <p>
   The first part before the dot is the reference to the entity we want to affect. This is called a reference.
  </p>
  <p>
   In this example we were using an
   <i>
    Immediate reference
   </i>
   .
  </p>
  <p>
   Immediate references are simple: if you know the name of the entity in the map, then you just stick a $ and write the name.
  </p>
  <p>
   In this case there would have to be an entity named "my_entity" in the map.
  </p>
  <div>
   <a class="image" href="Image:Etqwsquare_25.png" title="Image:Etqwsquare_25.png">
    <img alt="Image:Etqwsquare_25.png" height="25" longdesc="/wiki/Image:Etqwsquare_25.png" src="/w/images/7/7e/Etqwsquare_25.png" width="25"/>
   </a>
   <b>
    Note:
   </b>
   Enemy Territory: Quake Wars only:
   <dl>
    <dd>
     <i>
      (Enemy Territory does not have support for immediate references.)
     </i>
    </dd>
   </dl>
  </div>
  <a name="The_calling">
  </a>
  <h3>
   The calling
  </h3>
  <p>
   Next, the dot .
  </p>
  <p>
   It simply indicates that the following will be a function call on the referenced entity.
  </p>
  <p>
   In this case it's a
   <a class="new" href="Script_event" title="Script event">
    script event
   </a>
   . setWorldOrigin is an event that sets the position of the entity in the world. We won't worry further about this because it's not a functional example.
  </p>
  <a name="The_other_way_to_reference">
  </a>
  <h3>
   The other way to reference
  </h3>
  <p>
   Using a named reference. We can declare a variable as an entity reference.
  </p>
  <pre> 
<span style="color: #0000ff;">entity</span> myEntityReference;</pre>
  <p>
   Then we'll be able to set it to what we want, reset it to reference another entity, or set it to references returned from functions.
  </p>
  <p>
   In this case we are going to set it to our pal named "my_entity" which we know is in the map (theoretically, for this example).
  </p>
  <pre> 
myEntityReference = <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span> <span style="color: #666666;">"my_entity"</span> <span style="color: #000000;">)</span>;</pre>
  <p>
   What sys.getEntity does is look for the entity name we pass in, and returns a reference to it, which we are catching in our own reference.
  </p>
  <p>
   Now we have our reference set we can call a function on it like in the first example.
  </p>
  <pre> 
myEntityReference.<span style="color: #ff0000;">setWorldOrigin</span><span style="color: #000000;">(</span>'<span style="color: #0000dd;">57</span> <span style="color: #0000dd;">68</span> <span style="color: #0000dd;">19</span>'<span style="color: #000000;">)</span>;</pre>
  <p>
   Fantastic.
  </p>
  <a name="sys">
  </a>
  <h3>
   sys
  </h3>
  <p>
   In a similar way to accessing entities we can access the system events on the current thread using the sys identifier. It is for events that don't really make much sense being part of an entity, like game functions and utilities.
  </p>
  <p>
   Looking at the list for Doom 3
   <a href="Script_events_%28Doom_3%29#System_Events" title="Script events (Doom 3)">
    Doom 3 System events
   </a>
   we can see there's a lot of sys events.
  </p>
  <p>
   In this example we call two events via sys:
  </p>
  <p>
   getTime, which returns the time in seconds since the game started.
  </p>
  <p>
   println, which prints a line of text to the console.
  </p>
  <pre><span style="color: #0000ff;">void</span> printTime<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 <span style="color: #0000ff;">float</span> tempfloat;
 tempfloat = <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getTime</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
 <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span><span style="color: #666666;">"Current game time is "</span> + tempfloat + <span style="color: #666666;">" seconds."</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   You'll see in the first part we stored the game time in a variable, then added it to the string we were creating as the parameter for println.
  </p>
  <p>
   The scripting system makes it easy to work with strings, you can append other strings, different variables simply with the + operator.
  </p>
  <a name="Spawning_entities">
  </a>
  <h3>
   Spawning entities
  </h3>
  <p>
   (More info on sys.spawn() and an example. See Q4 wiki @
   <a class="external autonumber" href="http://www.iddevnet.com/quake4/BasicScriptTutorial" title="http://www.iddevnet.com/quake4/BasicScriptTutorial">
    [1]
   </a>
   )
  </p>
  <a name="Example">
  </a>
  <h3>
   Example
  </h3>
  <pre><span style="color: #0000ff;">void</span> moveEntity<span style="color: #000000;">(</span><span style="color: #0000ff;">entity</span> tempentity<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 <span style="color: #0000ff;">vector</span> tempvector='-<span style="color: #0000dd;">128</span> -<span style="color: #0000dd;">128</span> <span style="color: #0000dd;">0</span>';
 tempentity.<span style="color: #ff0000;">moveToPos</span><span style="color: #000000;">(</span>tempvector<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
<span style="color: #339900;">//note: the entity must be a func_mover or this won't work.</span>
 
<span style="color: #0000ff;">void</span> printEntityLocation<span style="color: #000000;">(</span><span style="color: #0000ff;">entity</span> tempentity<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
 <span style="color: #0000ff;">vector</span> tempvector;
 <span style="color: #0000ff;">string</span> tempstring=<span style="color: #666666;">"Entity is at map location: "</span>;
 tempvector=tempentity.<span style="color: #ff0000;">getOrigin</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
 <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">println</span><span style="color: #000000;">(</span>tempstring + tempvector<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
 
<span style="color: #339900;">//the following script can use the preceding examples</span>
<span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span> 
 <span style="color: #0000ff;">entity</span> funcmover;
 funcmover=<span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span><span style="color: #666666;">"func_mover_1"</span><span style="color: #000000;">)</span>;
 printEntityLocation<span style="color: #000000;">(</span>funcmover<span style="color: #000000;">)</span>; <span style="color: #339900;">//display the original location</span>
 moveEntity<span style="color: #000000;">(</span>funcmover<span style="color: #000000;">)</span>;
 <span style="color: #339900;">//now pause so that the game can move the entity using either</span>
 <span style="color: #339900;">//the following statement to allow just one game frame...</span>
 <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">waitFrame</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #339900;">//so that the mover has moved some, but not all the way.</span>
 <span style="color: #339900;">//or with this one</span>
 <span style="color: #339900;">//sys.waitFor(funcmover); //to wait until the entire move is completed.</span>
 printEntityLocation<span style="color: #000000;">(</span>funcmover<span style="color: #000000;">)</span>; <span style="color: #339900;">//display the current location</span>
<span style="color: #000000;">}</span></pre>
  <a name="Overview_of_script_events">
  </a>
  <h3>
   Overview of script events
  </h3>
  <p>
   A reference of scripting commands (events) can be found on the
   <a href="Script_events" title="Script events">
    script events
   </a>
   page.
  </p>
  <p>
   Keep in mind that all commands are case sensitive.
  </p>
  <a name="Threads">
  </a>
  <h2>
   Threads
  </h2>
  <p>
   In all previous parts of code, we assumed that a called function would always return. What if we call a function which will never end, but still want to run some other code?
  </p>
  <p>
   Let's take a closer look by means of an example. Suppose we want to make two machines run and write the following code:
  </p>
  <pre> 
<span style="color: #0000ff;">void</span> runMachine1<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">vector</span> up = '<span style="color: #0000dd;">0</span> -<span style="color: #0000dd;">128</span> <span style="color: #0000dd;">0</span>';
    <span style="color: #0000ff;">vector</span> down = '<span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span>';
    <span style="color: #0000ff;">entity</span> part = <span style="color: #000055;">$machinemover1</span>;
    <span style="color: #0000ff;">while</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        part .<span style="color: #ff0000;">moveToPos</span><span style="color: #000000;">(</span> up <span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">waitFor</span><span style="color: #000000;">(</span> part <span style="color: #000000;">)</span>;
        part.<span style="color: #ff0000;">moveToPos</span><span style="color: #000000;">(</span>down<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">waitFor</span><span style="color: #000000;">(</span> part <span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> runMachine2<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">vector</span> up = '-<span style="color: #0000dd;">128</span> -<span style="color: #0000dd;">128</span> <span style="color: #0000dd;">0</span>';
    <span style="color: #0000ff;">vector</span> down = '-<span style="color: #0000dd;">128</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span>';
    <span style="color: #0000ff;">entity</span> part = <span style="color: #000055;">$machinemover1</span>;
    <span style="color: #0000ff;">while</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        part .<span style="color: #ff0000;">moveToPos</span><span style="color: #000000;">(</span> up <span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">waitFor</span><span style="color: #000000;">(</span> part <span style="color: #000000;">)</span>;
        part.<span style="color: #ff0000;">moveToPos</span><span style="color: #000000;">(</span>down<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">waitFor</span><span style="color: #000000;">(</span> part <span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
 
<span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    runMachine1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    runMachine2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   Making them run for the duration of the map might not be so obvious as it appears. The
   <b>
    while
   </b>
   loop will keep on running. However, this will stop the code for machine 2 to be called because
   <i>
    runMachine1
   </i>
   () is still running. Switching the order of the function calls in the
   <i>
    main
   </i>
   routine is not an option either. So how to make both code blocks execute separated from each other?
  </p>
  <p>
   That is where
   <a href="Thread_%28scripting%29" title="Thread (scripting)">
    threads
   </a>
   come into play. Threads execute code without disturbing the flow of other threads. (Exceptions exist, which will be discussed later.) If we would now call a never-ending function, we would run it in a different thread so the function calling it can still execute other statements.
  </p>
  <p>
   Doom 3 can't change random parts of code into threads, only functions can be run as a thread. In fact, it is only a matter of putting the
   <b>
    thread
   </b>
   statement in front of a normal function call.
  </p>
  <p>
   The updated
   <i>
    main
   </i>
   routine for the previous example:
  </p>
  <pre><span style="color: #0000ff;">void</span> main<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #0000ff;">thread</span> runMachine1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">thread</span> runMachine2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
  <p>
   Now both functions run in a separate thread and run happily ever after.
  </p>
  <a name="Special_uses">
  </a>
  <h3>
   Special uses
  </h3>
  <div class="boilerplate metadata" id="stub">
   <i>
    This article is a
    <a class="external text" href="http://en.wikipedia.org/wiki/Perfect_stub_article" title="http://en.wikipedia.org/wiki/Perfect_stub_article">
     stub
    </a>
    . You can help us by
    <span class="plainlinks">
     <a class="external text" href="Scripting_basics" title="http://www.modwiki.net/w/index.php?title=Scripting_basics&amp;action=edit">
      expanding it
     </a>
    </span>
    .
   </i>
  </div>
  <p>
   TODO: explain threadnames, killThread, thread-ids and terminate.
  </p>
  <a name="Namespaces">
  </a>
  <h2>
   Namespaces
  </h2>
  <p>
   These Declare a block which can include functions and variables, avoiding name conflicts. (similar to C++ namespaces)
  </p>
  <p>
   These are used in Doom 3 to isolate a map script's functions and variables from the others.
  </p>
  <p>
   To get access to a member of a namespace, the following syntax is used:
  </p>
  <pre>namespace::member</pre>
  <p>
   The main.script and attendant event.script are part of the default, global namespace.
  </p>
  <a name="Objects">
  </a>
  <h2>
   Objects
  </h2>
  <p>
   A script object is a way of organizing variables and functions that are related to an
   <a href="Entity" title="Entity">
    entity
   </a>
   . It is analogous to a class in object orientated programming terms.
  </p>
  <p>
   Its uses are wide, ranging from weapons and AI, to extending existing entities.
  </p>
  <p>
   While an entity's
   <a href="Spawn_class" title="Spawn class">
    spawn class
   </a>
   strongly defines runtime behavior, script objects are generally used to create variation on that behavior within its framework.
  </p>
  <p>
   The spawn class sets up and runs a script object if the key/value pair "scriptobject" on the entity's
   <a href="SpawnArgs" title="SpawnArgs">
    spawnArgs
   </a>
   is set to a valid object type.
  </p>
  <a name="Working_on_objects">
  </a>
  <h3>
   Working on objects
  </h3>
  <p>
   In order to call a function of a script object a valid object reference must be set up.
  </p>
  <p>
   Example:
  </p>
  <pre> 
monster_base myMonster; 
myMonster = <span style="color: #0000ff;">sys</span>.<span style="color: #ff0000;">getEntity</span><span style="color: #000000;">(</span><span style="color: #666666;">"monster_sam"</span><span style="color: #000000;">)</span>;
myMonster.<span style="color: #ff0000;">wake_on_trigger</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
  <p>
   Line 1 declares an object reference of monster_base type. The script compiler will issue an
   <a class="new" href="Error" title="Error">
    error
   </a>
   if there is no script object of that type.
  </p>
  <p>
   <br/>
   Line 2 sets the reference to an entity. For the sake of this example we are assuming the entity "monster_sam" is an entity running a script object of monster_base type, or one that inherits monster_base. An object reference will be set to
   <a href="%24null_entity_%28scripting%29" title="$null entity (scripting)">
    $null_entity
   </a>
   if the entity you are trying to set the variable to does not have a object of that type.
  </p>
  <p>
   <br/>
   Line 3 calls the object function wake_on_trigger(), which we know is a function defined in the script object monster_base. 
If the function was not declared in the script object the script interpreter would issue a
   <a class="new" href="Warning" title="Warning">
    warning
   </a>
   .
  </p>
  <a name="Creating_your_own_script_object">
  </a>
  <h3>
   Creating your own script object
  </h3>
  <p>
   See
   <a href="Script_object#Example" title="Script object">
    Script object#Example
   </a>
   .
  </p>
  <a name="Advanced_aspects">
  </a>
  <h2>
   Advanced aspects
  </h2>
  <p>
   (will be moved on page overhaul)
  </p>
  <a name="virtual_functions">
  </a>
  <h3>
   virtual functions
  </h3>
  <p>
   Declares a function on base script object type.
Used for more advanced scripting techniques.
Should only be declared in
   <a class="new" href="Global_namespace" title="Global namespace">
    global namespace
   </a>
   .
  </p>
  <!-- Saved in parser cache with key modwiki:pcache:idhash:1322-0!1!0!0!!en!2 and timestamp 20121115111908 -->
 </body>
</html>
